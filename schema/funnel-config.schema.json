{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/loglion/funnel-config-schema",
  "title": "LogLion Funnel Configuration",
  "description": "Schema for LogLion funnel configuration files",
  "type": "object",
  "required": ["name", "steps"],
  "additionalProperties": false,
  "properties": {
    "name": {
      "type": "string",
      "minLength": 1,
      "description": "Name of the funnel"
    },
    "steps": {
      "type": "array",
      "minItems": 1,
      "maxItems": 100,
      "description": "Array of funnel steps (minimum 1, maximum 100)",
      "items": {
        "type": "object",
        "required": ["name", "event_pattern"],
        "additionalProperties": false,
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "description": "Name of the step (must be unique within the funnel)"
          },
          "event_pattern": {
            "type": "string",
            "minLength": 1,
            "pattern": "^.*$",
            "description": "Regular expression pattern to match events"
          },
          "required_properties": {
            "type": "object",
            "additionalProperties": {
              "type": "string",
              "minLength": 1,
              "description": "Regular expression pattern for property value"
            },
            "description": "Map of property names to regex patterns that must match"
          }
        }
      }
    }
  }
}